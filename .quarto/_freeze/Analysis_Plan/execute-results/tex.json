{
  "hash": "5c12f76dc4122f7d93498f157e849cc8",
  "result": {
    "markdown": "---\ntitle: \"The Plan\"\nformat: \n  html:\n    self-contained: true\n    code-line-numbers: true\n  pdf: \n    documentclass: article\ncustom_title_page: false\nfilters:\n  - lightbox\nlightbox: auto\n---\n\n---\nsubtitle: \"Planing the data cleaning and data analysis\"\ndate: 2023-02-27\n\nauthor:\n  - name: Javier Silva-Valencia\n    orcid: 0000-0002-5982-2821\n    email: javier.silva@unmsm.edu.pe\n    affiliations:\n      - name: Instituut Voor Tropische Geneeskunde. Antwerp-Belgium\n\nlanguage: \n  title-block-author-single: \"Writer\"\n---\n\n\n\n------------------------------------------------------------------------\n\n------------------------------------------------------------------------\n\n## Material to Work\n\nAs a result of the survey (which was carried out at different times and/or using different units of analysis), five different data sets plus a list of codes were obtained.\n\n### 1. Dataset: Q1_B\n\nThe unit of this data set is a household. It contains information about environmental factors such as the presence of certain trees, water bodies, wall material, organic material and mosquito nets\n\n\n\n::: {.cell hash='Analysis_Plan_cache/pdf/unnamed-chunk-1_ee62fe2aab78fa578960b50b2cc28dba'}\n\n```{.r .cell-code .numberLines}\nsetwd(\"C:/Users/pined/OneDrive - Universidad Nacional Mayor de San Marcos/Javier 2022/Belgica/AC2_DataAnalysis_ThWk/Data_Analysis_Course_CaseBihar\") \n```\n:::\n\n::: {.cell hash='Analysis_Plan_cache/pdf/unnamed-chunk-2_38bc734d4f4b2293345aaffbdfc70b60'}\n\n```{.r .cell-code .numberLines}\nQ1_B <- read.csv(\"Material/Q1_B.csv\", sep=\",\", dec= \".\")\nstr(Q1_B)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n'data.frame':\t13377 obs. of  40 variables:\n $ ID                 : int  1 2 3 4 5 6 7 8 9 10 ...\n $ FSN                : num  45001 45002 45003 45004 45005 ...\n $ Neem_Tree          : num  0 0 0 0 0 0 0 0 0 0 ...\n $ Neem_Tree_Distance : num  -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 ...\n $ Neem_Tree_Size     : num  -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 ...\n $ Neem_Tree_Age      : num  -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 ...\n $ Neem_Tree_Usage    : chr  \"\" \"\" \"\" \"\" ...\n $ Neem_Tree_Use_Other: chr  \"\" \"\" \"\" \"\" ...\n $ Bamboo_Tree        : num  1 1 1 1 1 1 1 1 1 1 ...\n $ Bamboo_Tree_Dist   : num  3 10 16 17 5 4 15 3 1 10 ...\n $ Banana_Tree        : num  0 0 0 0 0 0 0 1 1 0 ...\n $ Banana_Tree_Dist   : num  -1 -1 -1 -1 -1 -1 -1 5 1 -1 ...\n $ Rice_Field         : num  1 1 1 1 1 1 1 1 1 1 ...\n $ Rice_Field_Dist    : num  4 12 16 13 4 13 10 10 7 12 ...\n $ Perm_Water_Body    : num  0 0 0 0 0 0 0 0 0 0 ...\n $ Perm_Wat_Body_Dist : num  -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 ...\n $ Wat_Body_Mid_Point : num  -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 ...\n $ No_Mosquito_Net    : num  0 2 1 0 0 0 0 0 1 0 ...\n $ Sprayed_2010       : num  86 86 86 86 86 86 86 86 86 86 ...\n $ Sprayed_2009       : num  86 86 86 86 86 86 86 86 86 86 ...\n $ Floor_Material     : num  153 153 153 153 153 153 153 153 155 153 ...\n $ Other_Floor_Mat    : num  -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 ...\n $ Is_Floor_Damp      : num  1 1 1 1 1 1 1 1 0 1 ...\n $ Roof_Material      : num  161 159 158 156 156 156 156 158 158 156 ...\n $ Other_Roof_Material: num  -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 ...\n $ Wall_Material      : num  164 164 164 162 163 163 162 164 164 162 ...\n $ Other_Wall_Material: num  -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 ...\n $ Windows_in_Room    : num  1 1 1 0 0 0 0 1 1 0 ...\n $ Granaries_in_HH    : num  1 1 1 0 1 1 0 1 1 0 ...\n $ Source_Drink_Water : num  167 167 92 92 92 92 92 92 92 92 ...\n $ Other_Src_Drink_Wat: num  -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 ...\n $ Toilet_Facility    : num  177 177 177 177 177 177 177 177 177 177 ...\n $ Other_Toilet_Fac   : num  -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 ...\n $ Cooking_Fuel       : num  180 180 180 180 180 180 180 180 180 180 ...\n $ Other_Cooking_Fuel : num  -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 ...\n $ Source_Light       : num  182 182 182 182 182 182 182 182 182 182 ...\n $ Other_Source_Light : num  -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 ...\n $ Electricity_in_HH  : num  0 0 0 0 0 0 0 0 0 0 ...\n $ No_Of_Rooms        : num  2 2 3 1 2 3 2 1 3 1 ...\n $ No_Sleeping_Rooms  : num  2 2 2 1 2 2 2 1 1 1 ...\n```\n:::\n:::\n\n::: {.cell hash='Analysis_Plan_cache/pdf/unnamed-chunk-3_fe93d9d1893c2a920449a22a2c48cf5d'}\n\n```{.r .cell-code .numberLines}\nsum(duplicated(Q1_B$FSN))   #Counting duplicate values in FSN collumn\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0\n```\n:::\n:::\n\n\n\n::: callout-tip\nThere is no duplicates rows in FSN (Household number). So each row is a unique household\n:::\n\n### 2. Dataset: \"Q1_B\\_1\"\n\nThe unit of this data set is the animals in the household. It contains information about the owning of animals. Each row refers to an animal from a household.\n\n\n\n::: {.cell hash='Analysis_Plan_cache/pdf/unnamed-chunk-4_c7e66e0bf833f30c90c3e0ccd8ee36ba'}\n\n```{.r .cell-code .numberLines}\nQ1_B_1 <- read.csv(\"Material/Q1_B_1.csv\", sep=\",\", dec= \".\")\nstr(Q1_B_1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n'data.frame':\t9029 obs. of  6 variables:\n $ FSN              : int  45001 45001 45002 45003 45004 45006 45009 45021 45021 45024 ...\n $ Animal_Name      : chr  \"Goats\" \"Poultry (chickens, ducks, pigeon)\" \"Buffaloes\" \"Cows/Oxen\" ...\n $ Animal_Count     : int  3 1 1 1 2 2 7 3 1 3 ...\n $ Animal_Distance  : int  5 0 4 3 5 0 0 15 5 15 ...\n $ Keep_Inside_House: int  1 1 0 1 1 1 1 0 1 1 ...\n $ Days_Inside_House: int  120 365 -1 210 180 360 360 -1 150 90 ...\n```\n:::\n:::\n\n::: {.cell hash='Analysis_Plan_cache/pdf/unnamed-chunk-5_e83c8d1292d3f27b690258b841789f13'}\n\n```{.r .cell-code .numberLines}\nsum(duplicated(Q1_B_1$FSN)) #Counting duplicate values in FSN column\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1882\n```\n:::\n:::\n\n\n\n::: callout-tip\nThere are 1882 duplicates in FSN column (Household number). This means that some households have more than one type of animal\n:::\n\n### 3. Dataset: \"Q1_B_106\"\n\nThe unit of this data set is a household. It contains information about durable consumer goods at the level of the household.\n\n\n\n::: {.cell hash='Analysis_Plan_cache/pdf/unnamed-chunk-6_63eaac9497f599fb668b8d3b3939420f'}\n\n```{.r .cell-code .numberLines}\nQ1_B_106 <- read.csv(\"Material/Q1_B_106.csv\", sep=\",\", dec= \".\")\nstr(Q1_B_106)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n'data.frame':\t13377 obs. of  25 variables:\n $ FSN             : int  45001 45002 45003 45004 45005 45006 45007 45008 45009 45010 ...\n $ Radio           : int  1 1 -1 -1 -1 -1 -1 -1 -1 -1 ...\n $ CD_Player       : int  -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 ...\n $ BW_Television   : int  -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 ...\n $ Color_Television: int  -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 ...\n $ Video_DVD_Player: int  -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 ...\n $ Mobile          : int  -1 -1 -1 -1 -1 1 -1 -1 -1 -1 ...\n $ Non_Mobile_Phone: int  -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 ...\n $ Refrigerator    : int  -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 ...\n $ Iron            : int  -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 ...\n $ Sewing_Machine  : int  -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 ...\n $ Watch           : int  -1 -1 -1 -1 -1 1 -1 -1 -1 -1 ...\n $ Pressure_Cooker : int  -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 ...\n $ Chairs          : int  1 -1 -1 -1 1 1 -1 -1 2 -1 ...\n $ Sofas           : int  -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 ...\n $ Tables          : int  -1 -1 -1 -1 -1 1 -1 -1 -1 -1 ...\n $ Cot_Bed         : int  2 2 3 -1 2 1 2 1 2 -1 ...\n $ Cupboards       : int  -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 ...\n $ Bicycle         : int  1 1 1 -1 -1 2 -1 -1 1 -1 ...\n $ Motor_Cycle     : int  -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 ...\n $ Animal_Draw_Cart: int  -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 ...\n $ Car             : int  -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 ...\n $ Tractor         : int  -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 ...\n $ Computer        : int  -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 ...\n $ Electric_Fan    : int  -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 ...\n```\n:::\n:::\n\n::: {.cell hash='Analysis_Plan_cache/pdf/unnamed-chunk-7_35431beecb8635157a5a2662ac6740c5'}\n\n```{.r .cell-code .numberLines}\nsum(duplicated(Q1_B_106$FSN)) #Counting duplicate values in FSN column\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0\n```\n:::\n:::\n\n\n\n::: callout-tip\nThere is no duplicates rows in FSN (Household number). So each row is a unique household\n:::\n\n### 4. Dataset: Q1_Screening\n\nThe unit of this data set is a person. It contains information about the age and sex of every person in a household as well if they were cases (had suffered visceral leshmaniasis since second survey)\n\n\n\n::: {.cell hash='Analysis_Plan_cache/pdf/unnamed-chunk-8_c9c1ffac8c52167943f82d4e50ef9488'}\n\n```{.r .cell-code .numberLines}\nQ1_Screening <- read.csv(\"Material/Q1_Screening.csv\", sep=\",\", dec= \".\")\nstr(Q1_Screening)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n'data.frame':\t81214 obs. of  10 variables:\n $ FSN                         : int  45001 45001 45001 45001 45001 45001 45002 45002 45002 45002 ...\n $ member_id                   : int  1 2 3 4 5 6 1 2 3 4 ...\n $ member_age                  : int  50 48 25 22 0 11 35 33 17 15 ...\n $ member_sex                  : int  2 3 2 3 2 2 2 3 2 2 ...\n $ fever_gt_3_days             : int  0 0 0 0 0 0 0 0 0 0 ...\n $ suffered_vl_since_2nd_survey: int  0 0 0 0 0 0 0 0 0 0 ...\n $ date_diagnosis              : chr  \"\" \"\" \"\" \"\" ...\n $ treatment_place             : chr  \"-1\" \"-1\" \"-1\" \"-1\" ...\n $ current_status              : int  0 0 4 0 0 0 0 0 4 0 ...\n $ datedis                     : int  NA NA NA NA NA NA NA NA NA NA ...\n```\n:::\n:::\n\n\n\n### 5. Dataset: Questionnaire_1\n\nThe unit of this data set is the household. It contains information about the number and id of the village as well some demographic information about the head of the household\n\n\n\n::: {.cell hash='Analysis_Plan_cache/pdf/unnamed-chunk-9_b88c67dd4ec7be66859efe5f4c3b0de8'}\n\n```{.r .cell-code .numberLines}\nQuestionnaire_1 <- read.csv(\"Material/Questionnaire_1.csv\", sep=\",\", dec= \".\")\nstr(Questionnaire_1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n'data.frame':\t13377 obs. of  10 variables:\n $ FSN                    : int  45001 45002 45003 45004 45005 45006 45007 45008 45009 45010 ...\n $ panchyat_id            : int  2 2 2 2 2 2 2 2 2 2 ...\n $ village_id             : int  11 11 11 11 11 11 11 11 11 11 ...\n $ ward_no                : int  1 1 1 1 1 1 1 1 1 1 ...\n $ household_no           : int  21 680 290 3390 181 3501 1401 2330 3750 2371 ...\n $ household_head_age     : int  50 35 60 35 40 40 60 23 25 40 ...\n $ household_head_sex     : int  2 2 2 2 2 2 2 2 2 3 ...\n $ household_head_religion: int  4 4 4 4 4 4 4 4 4 4 ...\n $ household_head_caste   : int  9 9 9 9 9 9 9 9 9 9 ...\n $ household_head_subcaste: chr  \"PASWAN\" \"PASWAN\" \"PASWAN\" \"PASWAN\" ...\n```\n:::\n:::\n\n\n\n### 6. Code_List\n\nThis file contains the interpretation of all the codes used among all datasets.\n\n\n\n::: {.cell hash='Analysis_Plan_cache/pdf/unnamed-chunk-10_ce956917575b5f47a346c8f8ac7f971a'}\n\n```{.r .cell-code .numberLines}\nCode_List <- read.csv(\"Material/Code_List.csv\", sep=\",\", dec= \".\")\nhead(Code_List, 10)  #Example of 10 first codes meaning\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   Code                                          Code_Text\n1   183                                            Candles\n2    -1                                           No Value\n3   184                                           Brushing\n4   185 Leaves/Seeds used as insecticide for grain storage\n5   186                 Neem Oil used for skin application\n6   187                        Burn leaves to create smoke\n7   188                                          Not Using\n8     0                                                 No\n9     1                                                Yes\n10    2                                               Male\n```\n:::\n:::\n\n\n\n\n------------------------------------------------------------------------\n\n------------------------------------------------------------------------\n\n## Data Cleaning Plan\n\nThe aim of data cleaning is to create a single data set with all the variables of importance. This involves checking the NA values, creating an asset index (using the consumer goods variables), reshaping some data to work on the same unit, and merging all data sets.\n\n### 1. Reshape Q1_B_1 \n(Data of animals in household). We will reshape it so that each row should be a Household, in order to merge with other datasets. Replace values if need it. (NA, -1)\n\n\n\n```{mermaid}\n%%| fig-width: 3.5\nflowchart LR\n  A[Q1_B_1] -->|reshape| B(New dataset:animals)\n```\n\n\n\n### 2. Create an asset index\nThis index should include information of consumer goods, as well if having a bovine animal and if having a brick wall household.\n\n#### 2.1. Select consumer goods\nSelect the consumer goods from Q1_B_106 dataset.\n\n\n```{mermaid}\nflowchart LR\n  A[Q1_B_1] -->|transform to <br> dichotomous variables| B(New dataset:<br> assets)\n  B(New dataset:<br> assets) -->|only goods with prevalenc <br> between 5-95%| C(New dataset:<br> assets2)\n```\n\n\n\n#### 2.2. Create own_bovine variable \nUse the previously created \"animals\" dataset to create a variable of owning a bovine animal.\n\n\n```{mermaid}\nflowchart LR\n  A[animals] -->|subset of <br> bovine animals| B(New dataset:<br> hlp1)\n```\n\n\n#### 2.3. Create brickwall variables\nUse the Q1_B dataset to create a variable if the household have brickwalls.\n\n\n```{mermaid}\nflowchart LR\n  A[Q1_B] -->|subset of <br> brickwall variable| B(New dataset:<br> hlp2)\n```\n\n\n#### 2.4. Merging datasets \nMerge all this datasets in order to create the asset index\n\n\n```{mermaid}\nflowchart LR\n  A[hlp1] --> B(New dataset:<br> hlp)\n  C[hlp2] --> B(New dataset:<br> hlp)\n  B[New dataset:<br> hlp] --> D(New dataset:<br> assets3)\n  E[assets2] --> D(New dataset:<br> assets3)\n```\n\n\n#### 2.5. Use PCA to create asset_index \nCreate the asset index using the Principle component analysis (PCA)\n\n\n```{mermaid}\nflowchart LR\n  A[New dataset:<br> assets3] -->|Principle component <br> analysis| B(New dataset:<br> assets4)\n```\n\n\n\n\n### 3. Merging all the databases\n\n#### 3.1. Final Merging \n(Questionnaire_1 + asset index + animals + Q1_B + Q1_Screening)\n\n\n\n```{mermaid}\nflowchart LR\n  A[Questionnaire_1] --> B(Quest1_assets4)\n  C(assets4) --> B(Quest1_assets4)\n  B(Quest1_assets4) --> D(Quest1_assets4_animals)\n  E(animals) --> D(Quest1_assets4_animals)\n  D(Quest1_assets4_animals) --> F(Quest1_assets4_animals_q1B)\n  G(Q1_B) --> F(Quest1_assets4_animals_q1B)\n  F(Quest1_assets4_animals_q1B)--> H(Quest1_assets4_animals_q1B_Persons)\n  I(Q1_Screening)--> H(Quest1_assets4_animals_q1B_Persons)\n```\n\n\n\n#### 3.2. Select variables of interest\nFor the final dataset\n\n\n```{mermaid}\nflowchart LR\n  A(Quest1_assets4_animals_q1B_Persons) -->|selecting variables <br> of interes| B(final_dataset)\n```\n\n\n\n------------------------------------------------------------------------\n\n------------------------------------------------------------------------\n\n### Data Analysis Plan\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}